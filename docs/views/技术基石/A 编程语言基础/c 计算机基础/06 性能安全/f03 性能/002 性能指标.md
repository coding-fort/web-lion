# 性能指标

前端性能指标是衡量网页加载速度、交互响应性、视觉稳定性等用户体验的关键数据，直接影响用户留存、转化率和满意度。以下是核心且常用的前端性能指标分类及详细说明：

## 一、核心 Web 指标（Core Web Vitals）

由 Google 提出，聚焦用户最直观的体验，是评估网页质量的核心标准，包括三个关键指标：

### 1. 最大内容绘制（Largest Contentful Paint, LCP）

- **定义**：衡量页面**主要内容加载速度**的指标，指视口内最大的内容元素（如图片、文本块）完全渲染完成的时间。
- **意义**：反映用户“页面是否加载完成”的第一印象，直接关联“内容可用性”。
- **理想范围**：
  - 良好：≤ 2.5 秒
  - 需改进：2.5~4 秒
  - 差：> 4 秒
- **影响因素**：
  - 大图片、大文本块的加载/渲染延迟（如未压缩的图片、阻塞渲染的 JS/CSS）。
  - 服务器响应速度（TTFB）、网络传输延迟。
- **优化方向**：
  - 优先加载关键资源（如用 `<link rel="preload">` 预加载 LCP 元素）；
  - 压缩图片（WebP/AVIF 格式）、懒加载非首屏图片；
  - 减少阻塞渲染的 JS/CSS（内联关键 CSS、异步加载非关键 JS）。

### 2. 交互到下一次绘制（Interaction to Next Paint, INP）

- **定义**：衡量页面**交互响应速度**的指标，计算用户所有交互（点击、输入、滚动等）中“响应延迟最长”的那次（取第 98 百分位值），即从用户操作到浏览器渲染下一次画面的时间。
- **意义**：反映用户“操作是否流畅”的核心体验，替代了旧指标“首次输入延迟（FID）”（FID 仅衡量首次交互，覆盖场景有限）。
- **理想范围**：
  - 良好：≤ 200 毫秒
  - 需改进：200~500 毫秒
  - 差：> 500 毫秒
- **影响因素**：
  - 主线程阻塞（如长任务：JS 同步执行时间过长，导致无法及时响应交互）；
  - 事件监听函数执行缓慢（如复杂计算、DOM 操作）。
- **优化方向**：
  - 拆分长任务（用 Web Worker 处理计算逻辑，避免阻塞主线程）；
  - 减少不必要的事件监听，优化事件处理函数（如防抖节流）；
  - 压缩/延迟加载非关键 JS。

### 3. 累积布局偏移（Cumulative Layout Shift, CLS）

- **定义**：衡量页面**视觉稳定性**的指标，计算页面生命周期内所有“意外布局偏移”的总和。
  - 布局偏移：指元素在两帧之间的位置或尺寸意外变化（如图片未设置尺寸导致加载后撑开布局、动态插入内容推挤已有元素）。
  - 计算方式：每次偏移的“影响分数”（元素偏移面积占视口比例）×“距离分数”（元素偏移距离占视口比例），总和即为 CLS。
- **意义**：反映用户“操作是否被干扰”（如按钮突然移位导致误触），直接影响信任感。
- **理想范围**：
  - 良好：≤ 0.1
  - 需改进：0.1~0.25
  - 差：> 0.25
- **影响因素**：
  - 图片/视频未设置固定尺寸（width/height 属性或 CSS 尺寸）；
  - 动态插入内容（如广告、弹窗）未预留空间；
  - 字体加载导致的“ FOIT（无样式文本闪烁）”。
- **优化方向**：
  - 为媒体元素（img、video）设置明确尺寸；
  - 动态内容提前预留容器空间（如 min-height）；
  - 使用 `font-display: swap` 避免字体加载导致的布局偏移。

## 二、其他重要性能指标

除核心指标外，以下指标用于更细致地分析页面加载和交互过程：

### 1. 首次内容绘制（First Contentful Paint, FCP）

- **定义**：页面首次绘制任何“有意义内容”（文本、图片、SVG 等）的时间（区别于“首次绘制 FP”，FP 可能只是空白背景）。
- **意义**：用户感知“页面开始加载”的最早信号。
- **理想范围**：≤ 1.8 秒。

### 2. 首字节时间（Time to First Byte, TTFB）

- **定义**：从用户发起请求到浏览器接收到服务器返回的第一个字节的时间。
- **意义**：反映网络传输、服务器处理（如数据库查询、逻辑计算）的效率，是“后端性能”的直接体现。
- **理想范围**：≤ 600 毫秒（超过则说明服务器或网络存在瓶颈）。

### 3. 可交互时间（Time to Interactive, TTI）

- **定义**：页面完全加载并能“流畅响应用户交互”的时间（即：所有关键资源加载完成，主线程空闲，不会因 JS 执行阻塞交互）。
- **意义**：衡量页面从“能看到内容”到“能正常使用”的间隔，避免“假可用”状态（内容显示但点击无响应）。
- **理想范围**：≤ 3.8 秒。

### 4. 首次输入延迟（First Input Delay, FID）

- **定义**：用户首次与页面交互（如点击按钮、输入文本）到浏览器开始处理该交互的时间（已被 INP 替代，因 FID 仅衡量“首次”交互，覆盖场景有限）。
- **核心问题**：反映主线程被 JS 执行阻塞的程度（若主线程在处理长任务，用户输入会延迟响应）。

### 5. 总阻塞时间（Total Blocking Time, TBT）

- **定义**：从 FCP 到 TTI 期间，主线程被“长任务”（执行时间 > 50ms）阻塞的总时间（长任务超过 50ms 的部分累加）。
- **意义**：量化主线程繁忙程度，间接反映交互响应延迟的根源（长任务越多，TBT 越大，用户操作越容易卡顿）。
- **理想范围**：≤ 300 毫秒。

### 6. 资源加载相关指标

- **JS/CSS 加载/解析/执行时间**：衡量关键脚本、样式表的加载（如 `loadEventEnd`）、解析（Parse）、编译（Compile）和执行（Evaluate）耗时，过长会阻塞页面渲染和交互。
- **图片/字体加载时间**：如“ Largest Image Paint”（最大图片绘制时间）、“Font Loading Time”（字体加载完成时间），直接影响 LCP 和 CLS。

## 三、指标获取工具

- **真实用户监测（RUM）**：通过埋点收集真实用户访问数据（如 Google Analytics 4、百度统计、Sentry）。
- **实验室工具**：模拟环境测试（如 Lighthouse、WebPageTest、Chrome DevTools 的 Performance 面板）。

## 总结

前端性能指标的核心是“以用户为中心”：**加载快（LCP）、响应快（INP）、不晃动（CLS）**。优化时需结合具体指标定位瓶颈（如 LCP 差优先优化图片/服务器响应，CLS 差优先固定元素尺寸），最终目标是让用户“无感知”地流畅使用页面。
